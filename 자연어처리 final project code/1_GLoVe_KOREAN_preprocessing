{"cells":[{"cell_type":"markdown","metadata":{"id":"HJP7KQowZqg5"},"source":["# 전처리\n","\n","전처리 과정은 http://aidev.co.kr/nlp/9480, \n","\n","https://colab.research.google.com/drive/1FfhWsP9izQcuVl06P30r5cCxELA1ciVE?usp=sharing 를 복붙한 뒤 일부 수정했다.\n","\n","추가로 참조한 페이지\n","\n","https://wikidocs.net/50739\n","\n","https://somjang.tistory.com/entry/Google-Colab%EC%97%90%EC%84%9C-Mecab-koMecab-ko-dic-%EC%89%BD%EA%B2%8C-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0"]},{"cell_type":"markdown","metadata":{"id":"7Ym3Ye60zLU3"},"source":["#### 1. Importing\n","\n","\n","한국어 코퍼스로는 [위키 말뭉치]를 사용한다."]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9304,"status":"ok","timestamp":1652716974284,"user":{"displayName":"이성주","userId":"00188276470697632312"},"user_tz":-540},"id":"AonkbXhwf9yA","outputId":"9b40a84c-7865-4e81-8d35-06f47916b595"},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: Korpora in /usr/local/lib/python3.7/dist-packages (0.2.0)\n","Requirement already satisfied: requests>=2.20.0 in /usr/local/lib/python3.7/dist-packages (from Korpora) (2.23.0)\n","Requirement already satisfied: xlrd>=1.2.0 in /usr/local/lib/python3.7/dist-packages (from Korpora) (2.0.1)\n","Requirement already satisfied: dataclasses>=0.6 in /usr/local/lib/python3.7/dist-packages (from Korpora) (0.6)\n","Requirement already satisfied: tqdm>=4.46.0 in /usr/local/lib/python3.7/dist-packages (from Korpora) (4.64.0)\n","Requirement already satisfied: numpy>=1.18.0 in /usr/local/lib/python3.7/dist-packages (from Korpora) (1.21.6)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests>=2.20.0->Korpora) (2021.10.8)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests>=2.20.0->Korpora) (1.24.3)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests>=2.20.0->Korpora) (2.10)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests>=2.20.0->Korpora) (3.0.4)\n","Requirement already satisfied: kss in /usr/local/lib/python3.7/dist-packages (3.4.2)\n","Requirement already satisfied: more-itertools in /usr/local/lib/python3.7/dist-packages (from kss) (8.12.0)\n","Requirement already satisfied: regex in /usr/local/lib/python3.7/dist-packages (from kss) (2019.12.20)\n","Requirement already satisfied: emoji in /usr/local/lib/python3.7/dist-packages (from kss) (1.7.0)\n","Requirement already satisfied: konlpy in /usr/local/lib/python3.7/dist-packages (0.6.0)\n","Requirement already satisfied: lxml>=4.1.0 in /usr/local/lib/python3.7/dist-packages (from konlpy) (4.2.6)\n","Requirement already satisfied: JPype1>=0.7.0 in /usr/local/lib/python3.7/dist-packages (from konlpy) (1.3.0)\n","Requirement already satisfied: numpy>=1.6 in /usr/local/lib/python3.7/dist-packages (from konlpy) (1.21.6)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from JPype1>=0.7.0->konlpy) (4.2.0)\n"]}],"source":["!pip install Korpora\n","!pip install kss\n","!pip install konlpy"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6100,"status":"ok","timestamp":1652716980375,"user":{"displayName":"이성주","userId":"00188276470697632312"},"user_tz":-540},"id":"ED78zXqezJ1B","outputId":"5f6d54b0-93ae-43cd-c976-1f5f849f53c0"},"outputs":[{"name":"stdout","output_type":"stream","text":["\n","    Korpora 는 다른 분들이 연구 목적으로 공유해주신 말뭉치들을\n","    손쉽게 다운로드, 사용할 수 있는 기능만을 제공합니다.\n","\n","    말뭉치들을 공유해 주신 분들에게 감사드리며, 각 말뭉치 별 설명과 라이센스를 공유 드립니다.\n","    해당 말뭉치에 대해 자세히 알고 싶으신 분은 아래의 description 을 참고,\n","    해당 말뭉치를 연구/상용의 목적으로 이용하실 때에는 아래의 라이센스를 참고해 주시기 바랍니다.\n","\n","    # Description\n","    Author : Hyunjoong Kim lovit@github\n","    Repository : https://github.com/lovit/kowikitext\n","    References :\n","\n","    한국어 위키피디아의 덤프 데이터를 바탕을 제작한 wikitext 형식의 텍스트 파일입니다.\n","    학습 및 평가를 위하여 위키페이지 별로 train (99%), dev (0.5%), test (0.5%) 로 나뉘어져있습니다.\n","\n","\n","    # License\n","    CC-BY-SA 3.0 which kowiki dump dataset is licensed\n","\n","[Korpora] Corpus `kowikitext` is already installed at /root/Korpora/kowikitext/kowikitext_20200920.train.zip\n","[Korpora] Corpus `kowikitext` is already installed at /root/Korpora/kowikitext/kowikitext_20200920.train\n","[Korpora] Corpus `kowikitext` is already installed at /root/Korpora/kowikitext/kowikitext_20200920.test.zip\n","[Korpora] Corpus `kowikitext` is already installed at /root/Korpora/kowikitext/kowikitext_20200920.test\n","[Korpora] Corpus `kowikitext` is already installed at /root/Korpora/kowikitext/kowikitext_20200920.dev.zip\n","[Korpora] Corpus `kowikitext` is already installed at /root/Korpora/kowikitext/kowikitext_20200920.dev\n","kowikiText.train text file is large (1.6G).\n","If you want to load text in your memory, please insert `yes`\n","If the `INPUT` is integer, it loads only first `INPUT` sentences\n","10000\n"]}],"source":["from Korpora import Korpora\n","import kss\n","\n","Namu = False\n","if Namu: ## 나무위키 쓸경우\n","    corpus = Korpora.load(\"namuwikitext\")\n","else: ## 위키피디아 쓸경우\n","    corpus = Korpora.load(\"kowikitext\")\n","\n","sentences = corpus.get_all_texts()"]},{"cell_type":"code","source":["sentences[:10]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"i6RIcW3EFrkE","executionInfo":{"status":"ok","timestamp":1652716982439,"user_tz":-540,"elapsed":3,"user":{"displayName":"이성주","userId":"00188276470697632312"}},"outputId":"0e98d961-e973-4b21-a47e-85fbbeb2342c"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["['스폴리아텔레(, )는 이탈리아의 후식으로서 모양은 프랑스의 과자인 마들렌처럼 조개 모양이거나 긴 뿔 모양이기도 하다. 단어 \"sfogliatelle\"는  \"많은 잎 혹은 층\"을 의미하며 질감 자체가 여러 잎을 쌓아놓고 씹어먹는 듯한 바삭거리는 느낌이 있기 때문에 이 용어가 아주 잘 어울린다고 보기도 한다.\\n산타 로사라고 부르는 스폴리아텔레의 일종은 17세기 콩가 데이 마리니에서 생겨난 과자이다.\\n만들 때에는 반죽을 길고 얇게 만든 다음 쇼트닝을 두텁게 바른다. 다음으로는 계속 밀대에 반죽을 밀어서 롤처럼 만들 수 있게 반죽을 풍성하게 만든다. 가운데는 나중에 제거해서 다른 속을 채우도록 한다. 오렌지 맛이 나는 리코타 치즈를 넣기도 한다. 시트론이나 레몬 같은 과일을 넣기도 한다..\\n스폴리아텔레는 이탈리아의 나폴리에서 유래했으며 굉장히 만드는 데 시간이 많이 들기 때문에 수녀원 등지에서 형태가 생겨났다고 보고 있다.',\n"," '나폴리에서는  \"sfogliatella riccia\" 로 불리며 몰타에서는 세이보리를 속으로 채워넣어서 만들기도 한다. 몰타 사람들은 이런 형태의 스폴리아텔레를 \"Ricotta Pastizzi\"라고 부른다. 단 맛이 안나는 세이보리가 재료인 것이 특징인데 다른 종류인 \"Pastizzi tal-Pizelli\"는 같은 모양이지만 세이보리 열매나 새싹을 집어 넣는다. 이 반죽을 \"Ta L-Isfoll\"라고 칭한다.',\n"," '',\n"," '예술',\n"," '뎨산 구(, )는 중국 광시 좡족 자치구 우저우 시의 현급 행정구역이다. 넓이는 313km2이고, 인구는 2007년 기준으로 190,000명이다.',\n"," '연평균 기온은 21℃이고 연평균 강수량은 1485mm이다.',\n"," '3개 가도, 2개 진을 관할한다.\\n가도: 角嘴街道, 东兴街道, 富民街道.\\n진: 龙湖镇, 夏郢镇.',\n"," '1966년 FIFA 월드컵 아프리카·아시아·오세아니아 지역 예선은 1966년 FIFA 월드컵에 배정된 아프리카·아시아·오세아니아 지역에 배정된 1장의 출전권을 두고 조선민주주의인민공화국과 오스트레일리아가 펼친 지역 예선이다.\\n당시 FIFA가 아시아와 아프리카의 축구 수준이 너무 떨어진다고 판단해 아시아 지역(오세아니아 지역의 오스트레일리아 포함)과 아프리카 지역에 1장을 배정하고 이를 하나의 대륙별 예선으로 묶어 버렸다. 이에 대해 불만을 품은 아프리카 국가들은 예선에 참가할 계획이었던 17개국 중 15개국이 기권을 선언했으며(콩고 공화국은 참가 허가를 거부당했다), 대부분의 아시아 국가들도 불참했다.\\n아시아 지역 예선에는 대한민국과 조선민주주의인민공화국, 남아프리카 공화국과 오스트레일리아 단 네 팀만 참가하려고 했다. 하지만 대한민국은 당초 예선 경기 개최지가 일본에서 캄보디아로 변경된 것에 대한 항의의 표시로 기권하였다. 또한, 남아프리카 공화국은 다른 아프리카 팀들이 기권하는 바람에 아시아 지역 예선을 통해 본선에 진출하는 과정을 밟아야 했으나, 이마저도 인종 차별 정책인 아파르트헤이트로 인해 실격당하며 결과적으로 이 대회의 아프리카·아시아·오세아니아 지역 예선은 조선민주주의인민공화국과 오스트레일리아만이 1장의 본선 출전권을 놓고 다투게 되었다.',\n"," '아프리카 지역 예선은 본래 다음과 같이 치를 예정이었다.',\n"," '!width=15%| 1조\\n!width=15%| 2조\\n!width=15%| 3조\\n!width=15%| 4조\\n!width=15%| 5조\\n!width=15%| 6조']"]},"metadata":{},"execution_count":14}]},{"cell_type":"markdown","source":["#### 2. 빈 문장(' ') 제거하기 "],"metadata":{"id":"UrAu-Ka7Oryv"}},{"cell_type":"code","source":["print(len(sentences))\n","sentences0 = [sentence for sentence in sentences if len(sentence) > 0]\n","len(sentences0)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9NGAxp7fFvM6","executionInfo":{"status":"ok","timestamp":1652716985419,"user_tz":-540,"elapsed":280,"user":{"displayName":"이성주","userId":"00188276470697632312"}},"outputId":"1cb32f22-d89c-4b9c-9d8d-9a8558f953d5"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["36167\n"]},{"output_type":"execute_result","data":{"text/plain":["29878"]},"metadata":{},"execution_count":15}]},{"cell_type":"markdown","metadata":{"id":"VIwbpm3DYu_c"},"source":["#### 3. 기호제거\n","\n","단순 for문으로 돌리면 overflow발생 + 개느림!!  \n","pandas에 넣어 돌리면 2초컷"]},{"cell_type":"code","source":["import pandas as pd\n","sentences1 = pd.Series(sentences0)\n","sentences1 = sentences1.str.replace(\"[^ㄱ-ㅎㅏ-ㅣ가-힣 ]\",\"\")\n","sentences1[:5]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"h2Nqkn21EWcr","executionInfo":{"status":"ok","timestamp":1652716990611,"user_tz":-540,"elapsed":727,"user":{"displayName":"이성주","userId":"00188276470697632312"}},"outputId":"914a07ac-fd28-4f25-8d27-621c7d27f73b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:3: FutureWarning: The default value of regex will change from True to False in a future version.\n","  This is separate from the ipykernel package so we can avoid doing imports until\n"]},{"output_type":"execute_result","data":{"text/plain":["0    스폴리아텔레 는 이탈리아의 후식으로서 모양은 프랑스의 과자인 마들렌처럼 조개 모양이...\n","1    나폴리에서는    로 불리며 몰타에서는 세이보리를 속으로 채워넣어서 만들기도 한다 ...\n","2                                                   예술\n","3    뎨산 구 는 중국 광시 좡족 자치구 우저우 시의 현급 행정구역이다 넓이는 이고 인구...\n","4                               연평균 기온은 이고 연평균 강수량은 이다\n","dtype: object"]},"metadata":{},"execution_count":16}]},{"cell_type":"markdown","source":["#### 4. 형태소 분석기\n","\n","Okt, Komoran, Mecab(은전한닢), 한나눔, 꼬마 5개 분석기 있음  \n","은전한닢은 사용불가(Linux Dock나 Mac에서 사용해야한다고 함)    -> 따로불러오면 사용가능!!!!  \n","아래 셀로 함수화시켜놓았으니 하나씩 실험해보시길...\n","한줄짜리로 돌려본 결과, Okt = 꼬마 < 한나눔 < Komoran 순으로 빠름"],"metadata":{"id":"may3jEOOZDBh"}},{"cell_type":"code","source":["! git clone https://github.com/SOMJANG/Mecab-ko-for-Google-Colab.git"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"o2EXzWcQe0Ec","executionInfo":{"status":"ok","timestamp":1652800446274,"user_tz":-540,"elapsed":4,"user":{"displayName":"이성주","userId":"00188276470697632312"}},"outputId":"d9f57b5d-7c87-40ec-ec20-19d9acc1704d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["fatal: destination path 'Mecab-ko-for-Google-Colab' already exists and is not an empty directory.\n"]}]},{"cell_type":"code","source":["cd Mecab-ko-for-Google-Colab/"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"pVaGhdEtfJKE","executionInfo":{"status":"ok","timestamp":1652800449820,"user_tz":-540,"elapsed":3,"user":{"displayName":"이성주","userId":"00188276470697632312"}},"outputId":"8e4c7c08-b848-483f-efae-239b62772a99"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/Mecab-ko-for-Google-Colab\n"]}]},{"cell_type":"code","source":["#! bash install_mecab-ko_on_colab190912.sh\n","\n","! bash install_mecab-ko_on_colab_light_220429.sh\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cBbb1s-xffgC","executionInfo":{"status":"ok","timestamp":1652800485989,"user_tz":-540,"elapsed":35437,"user":{"displayName":"이성주","userId":"00188276470697632312"}},"outputId":"dc9328b3-980d-45d5-854a-70142c916670"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Installing konlpy.....\n","Requirement already satisfied: konlpy in /usr/local/lib/python3.7/dist-packages (0.6.0)\n","Requirement already satisfied: lxml>=4.1.0 in /usr/local/lib/python3.7/dist-packages (from konlpy) (4.2.6)\n","Requirement already satisfied: numpy>=1.6 in /usr/local/lib/python3.7/dist-packages (from konlpy) (1.21.6)\n","Requirement already satisfied: JPype1>=0.7.0 in /usr/local/lib/python3.7/dist-packages (from konlpy) (1.3.0)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from JPype1>=0.7.0->konlpy) (4.2.0)\n","Done\n","Installing mecab-0.996-ko-0.9.2.tar.gz.....\n","Downloading mecab-0.996-ko-0.9.2.tar.gz.......\n","from https://bitbucket.org/eunjeon/mecab-ko/downloads/mecab-0.996-ko-0.9.2.tar.gz\n","--2022-05-17 15:14:15--  https://bitbucket.org/eunjeon/mecab-ko/downloads/mecab-0.996-ko-0.9.2.tar.gz\n","Resolving bitbucket.org (bitbucket.org)... 104.192.141.1, 2406:da00:ff00::22cd:e0db, 2406:da00:ff00::3403:4be7, ...\n","Connecting to bitbucket.org (bitbucket.org)|104.192.141.1|:443... connected.\n","HTTP request sent, awaiting response... 302 Found\n","Location: https://bbuseruploads.s3.amazonaws.com/eunjeon/mecab-ko/downloads/mecab-0.996-ko-0.9.2.tar.gz?Signature=Ybp%2F88CJKUne%2BGGnZ26NLZwUedM%3D&Expires=1652802227&AWSAccessKeyId=AKIA6KOSE3BNA7WTAGHW&versionId=null&response-content-disposition=attachment%3B%20filename%3D%22mecab-0.996-ko-0.9.2.tar.gz%22&response-content-encoding=None [following]\n","--2022-05-17 15:14:16--  https://bbuseruploads.s3.amazonaws.com/eunjeon/mecab-ko/downloads/mecab-0.996-ko-0.9.2.tar.gz?Signature=Ybp%2F88CJKUne%2BGGnZ26NLZwUedM%3D&Expires=1652802227&AWSAccessKeyId=AKIA6KOSE3BNA7WTAGHW&versionId=null&response-content-disposition=attachment%3B%20filename%3D%22mecab-0.996-ko-0.9.2.tar.gz%22&response-content-encoding=None\n","Resolving bbuseruploads.s3.amazonaws.com (bbuseruploads.s3.amazonaws.com)... 52.217.105.84\n","Connecting to bbuseruploads.s3.amazonaws.com (bbuseruploads.s3.amazonaws.com)|52.217.105.84|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 1414979 (1.3M) [application/x-tar]\n","Saving to: ‘mecab-0.996-ko-0.9.2.tar.gz.2’\n","\n","mecab-0.996-ko-0.9. 100%[===================>]   1.35M  3.67MB/s    in 0.4s    \n","\n","2022-05-17 15:14:16 (3.67 MB/s) - ‘mecab-0.996-ko-0.9.2.tar.gz.2’ saved [1414979/1414979]\n","\n","Done\n","Unpacking mecab-0.996-ko-0.9.2.tar.gz.......\n","Done\n","Change Directory to mecab-0.996-ko-0.9.2.......\n","installing mecab-0.996-ko-0.9.2.tar.gz........\n","configure\n","make\n","make check\n","make install\n","ldconfig\n","Done\n","Change Directory to /content\n","Downloading mecab-ko-dic-2.1.1-20180720.tar.gz.......\n","from https://bitbucket.org/eunjeon/mecab-ko-dic/downloads/mecab-ko-dic-2.1.1-20180720.tar.gz\n","--2022-05-17 15:14:34--  https://bitbucket.org/eunjeon/mecab-ko-dic/downloads/mecab-ko-dic-2.1.1-20180720.tar.gz\n","Resolving bitbucket.org (bitbucket.org)... 104.192.141.1, 2406:da00:ff00::22c0:3470, 2406:da00:ff00::22e9:9f55, ...\n","Connecting to bitbucket.org (bitbucket.org)|104.192.141.1|:443... connected.\n","HTTP request sent, awaiting response... 302 Found\n","Location: https://bbuseruploads.s3.amazonaws.com/a4fcd83e-34f1-454e-a6ac-c242c7d434d3/downloads/b5a0c703-7b64-45ed-a2d7-180e962710b6/mecab-ko-dic-2.1.1-20180720.tar.gz?Signature=sERDxxQaf%2BitCX5lfHbq7ZqadPs%3D&Expires=1652802274&AWSAccessKeyId=AKIA6KOSE3BNA7WTAGHW&versionId=tzyxc1TtnZU_zEuaaQDGN4F76hPDpyFq&response-content-disposition=attachment%3B%20filename%3D%22mecab-ko-dic-2.1.1-20180720.tar.gz%22&response-content-encoding=None [following]\n","--2022-05-17 15:14:34--  https://bbuseruploads.s3.amazonaws.com/a4fcd83e-34f1-454e-a6ac-c242c7d434d3/downloads/b5a0c703-7b64-45ed-a2d7-180e962710b6/mecab-ko-dic-2.1.1-20180720.tar.gz?Signature=sERDxxQaf%2BitCX5lfHbq7ZqadPs%3D&Expires=1652802274&AWSAccessKeyId=AKIA6KOSE3BNA7WTAGHW&versionId=tzyxc1TtnZU_zEuaaQDGN4F76hPDpyFq&response-content-disposition=attachment%3B%20filename%3D%22mecab-ko-dic-2.1.1-20180720.tar.gz%22&response-content-encoding=None\n","Resolving bbuseruploads.s3.amazonaws.com (bbuseruploads.s3.amazonaws.com)... 52.217.100.220\n","Connecting to bbuseruploads.s3.amazonaws.com (bbuseruploads.s3.amazonaws.com)|52.217.100.220|:443... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 49775061 (47M) [application/x-tar]\n","Saving to: ‘mecab-ko-dic-2.1.1-20180720.tar.gz.1’\n","\n","mecab-ko-dic-2.1.1- 100%[===================>]  47.47M  33.6MB/s    in 1.4s    \n","\n","2022-05-17 15:14:36 (33.6 MB/s) - ‘mecab-ko-dic-2.1.1-20180720.tar.gz.1’ saved [49775061/49775061]\n","\n","Done\n","Unpacking  mecab-ko-dic-2.1.1-20180720.tar.gz.......\n","Done\n","Change Directory to mecab-ko-dic-2.1.1-20180720\n","Done\n","installing........\n","configure\n","make\n","make install\n","bash <(curl -s https://raw.githubusercontent.com/konlpy/konlpy/v0.6.0/scripts/mecab.sh)\n","https://github.com/konlpy/konlpy/issues/395#issue-1099168405 - 2022.01.11\n","Done\n","Install mecab-python\n","Successfully Installed\n","Now you can use Mecab\n","from konlpy.tag import Mecab\n","mecab = Mecab()\n","사용자 사전 추가 방법 : https://bit.ly/3k0ZH53\n","NameError: name 'Tagger' is not defined 오류 발생 시 런타임을 재실행 해주세요\n","블로그에 해결 방법을 남겨주신 tana님 감사합니다.\n","light 버전 작성 : Dogdriip님 ( https://github.com/Dogdriip )\n","문제를 해결해주신 combacsa님 감사합니다.\n"]}]},{"cell_type":"code","source":["from konlpy.tag import Okt, Komoran, Mecab, Hannanum, Kkma\n","\n","def get_tokenizer(tokenizer=None): ## default : Okt\n","    if tokenizer == 'komoran':\n","        token = Komoran()\n","    elif tokenizer == 'kkma':\n","        token = Kkma()\n","    elif tokenizer == 'hannanum':\n","        token = Hannanum()\n","    elif tokenizer == 'okt':\n","        token = Okt()\n","    else:\n","        token = Mecab()\n","    return token"],"metadata":{"id":"UQ_cbwYOPOZo"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["tokenizer = get_tokenizer()\n","sample = [\n","    \"정치권력\", '학생운동', '햇님', '해님', '햇빛', '내게', '네게', '제게', '뉘', '제가', '제 잘못', '뭔지도 모르고', '나더러', '너마저', '둘이서', '혼자서',\n","    '신이시여', '그는 좋다고 말했다', '사과와 배', '나와 함께', '사람들', '보고들 싶어서'\n","]\n","[tokenizer.pos(key) for key in sample]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ECyyBiRpGvFA","executionInfo":{"status":"ok","timestamp":1652804159171,"user_tz":-540,"elapsed":3,"user":{"displayName":"이성주","userId":"00188276470697632312"}},"outputId":"732f245f-69d9-4b90-f801-82a00ef7ddf1"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[[('정치권력', 'NNG')],\n"," [('학생', 'NNG'), ('운동', 'NNG')],\n"," [('햇님', 'NNG')],\n"," [('해님', 'NNG')],\n"," [('햇빛', 'NNG')],\n"," [('내게', 'NP+JKB')],\n"," [('네', 'NP+VCP'), ('게', 'EC')],\n"," [('제게', 'NP+JKB')],\n"," [('뉘', 'NP+JKS')],\n"," [('제', 'NP'), ('가', 'JKS')],\n"," [('제', 'NP+JKG'), ('잘못', 'MAG')],\n"," [('뭔지', 'NP+VCP+EC'), ('도', 'JX'), ('모르', 'VV'), ('고', 'EC')],\n"," [('나', 'NP'), ('더러', 'JKB')],\n"," [('너', 'NP'), ('마저', 'JX')],\n"," [('둘', 'NR'), ('이', 'VCP'), ('서', 'EC')],\n"," [('혼자', 'NNG'), ('서', 'JKB')],\n"," [('신', 'NNG'), ('이', 'VCP'), ('시', 'EP'), ('여', 'EC')],\n"," [('그', 'NP'),\n","  ('는', 'JX'),\n","  ('좋', 'VA'),\n","  ('다고', 'EC'),\n","  ('말', 'NNG'),\n","  ('했', 'XSV+EP'),\n","  ('다', 'EC')],\n"," [('사과', 'NNG'), ('와', 'JC'), ('배', 'NNG')],\n"," [('나', 'NP'), ('와', 'JKB'), ('함께', 'MAG')],\n"," [('사람', 'NNG'), ('들', 'XSN')],\n"," [('보고', 'NNG'), ('들', 'XSN'), ('싶', 'VX'), ('어서', 'EC')]]"]},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["sentences2 = sentences1.apply(tokenizer.pos)\n","sentences2"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0mC_mrXXaADl","executionInfo":{"status":"ok","timestamp":1652718696082,"user_tz":-540,"elapsed":17085,"user":{"displayName":"이성주","userId":"00188276470697632312"}},"outputId":"199fc5d2-91b3-435e-9c0d-d3bb2de4bc0f"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0        [(스폴, NNP), (리아, NNP), (텔레, NNP), (는, JX), (이탈...\n","1        [(나폴리, NNP), (에서, JKB), (는, JX), (로, NNG), (불리...\n","2                                              [(예술, NNG)]\n","3        [(뎨산, NNP), (구, VV), (는, ETM), (중국, NNP), (광시,...\n","4        [(연평균, NNG), (기온, NNG), (은, JX), (이, VV), (고, ...\n","                               ...                        \n","29873    [(홋카이도, NNP), (남부, NNG), (히다카, NNP), (산맥, NNG)...\n","29874    [(히다카, NNP), (지청, NNP), (사마니, NNP), (군, NNB), ...\n","29875    [(히다카, NNP), (지청, NNP), (사마니, NNP), (군, NNB), ...\n","29876    [(년, NNG), (급, NNG), (정촌, NNP), (제, NP), (가, J...\n","29877    [(어업, NNG), (이, JKS), (주로, MAG), (다시마, NNG), (...\n","Length: 29878, dtype: object"]},"metadata":{},"execution_count":41}]},{"cell_type":"markdown","source":["#### 형태소 거름망\n","\n","형태소 중 의미와 관련 있는 N(체언부), V(용언부), M(수식언부) 만 살림.  \n","J(조사)나 E(어미), X(접사)는 문법적 요소만을 위한 부분이므로 삭제"],"metadata":{"id":"TaGvnb2rqqqG"}},{"cell_type":"code","source":["def checkPOS(word):\n","    POS = ('NNG', 'NNP', 'NNB', 'NR', 'NP', 'VV', 'VA', 'VX', 'VCP', 'VCN', 'MM', 'MAG', 'MAJ', 'IC', 'XR')\n","    if word[1] in POS:\n","        return True\n","    return False"],"metadata":{"id":"IwWUlrJ0nyYe"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"aA8tEr59zLxG","executionInfo":{"status":"ok","timestamp":1652718703907,"user_tz":-540,"elapsed":1777,"user":{"displayName":"이성주","userId":"00188276470697632312"}},"outputId":"310ab532-e091-42bf-9bce-e2e947208132"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0        [(스폴, NNP), (리아, NNP), (텔레, NNP), (이탈리아, NNP),...\n","1        [(나폴리, NNP), (로, NNG), (불리, VV), (몰타, NNP), (세...\n","2                                              [(예술, NNG)]\n","3        [(뎨산, NNP), (구, VV), (중국, NNP), (광시, NNP), (좡족...\n","4        [(연평균, NNG), (기온, NNG), (이, VV), (연평균, NNG), (...\n","                               ...                        \n","29873    [(홋카이도, NNP), (남부, NNG), (히다카, NNP), (산맥, NNG)...\n","29874    [(히다카, NNP), (지청, NNP), (사마니, NNP), (군, NNB), ...\n","29875    [(히다카, NNP), (지청, NNP), (사마니, NNP), (군, NNB), ...\n","29876    [(년, NNG), (급, NNG), (정촌, NNP), (제, NP), (시행, ...\n","29877    [(어업, NNG), (주로, MAG), (다시마, NNG), (연어, NNG), ...\n","Length: 29878, dtype: object"]},"metadata":{},"execution_count":42}],"source":["#sentences3 = [word for sentence in sentences2 for word in sentence if checkPOS(word)] ## 리스트붕괴\n","sentences3 = sentences2.apply(lambda x: [word for word in x if checkPOS(word)])\n","sentences3"]},{"cell_type":"markdown","metadata":{"id":"eJljILB4Y8ZA"},"source":["#### Pandas Series에서 List로 변경"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"dHHP8g9cZRk8"},"outputs":[],"source":["sentences4 = sentences3.tolist()"]},{"cell_type":"markdown","source":["다했는데 저장이 안된다...."],"metadata":{"id":"QVGv27oe9sNP"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"mjopBVapZZFf","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1652720290703,"user_tz":-540,"elapsed":3655,"user":{"displayName":"이성주","userId":"00188276470697632312"}},"outputId":"f83dc70a-364f-4857-9097-419753d25b14"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /gdrive\n"]}],"source":["import pickle\n","from google.colab import drive\n","drive.mount('/content/drive', force_remount=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GxOgG11DbFXx","colab":{"base_uri":"https://localhost:8080/","height":266},"executionInfo":{"status":"error","timestamp":1652722202140,"user_tz":-540,"elapsed":262,"user":{"displayName":"이성주","userId":"00188276470697632312"}},"outputId":"6f277ce5-ecb2-4542-e6d9-a98d4c75b157"},"outputs":[{"output_type":"error","ename":"FileNotFoundError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mFileNotFoundError\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-78-a451dbdeb71b>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0mpath\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m\"https://drive.google.com/drive/folders/1WZs1R_DYdCaWE2LFtBQ7nFyA-YwcxnDn?usp=sharing/\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0mpath\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m\"drive/MyDrive/자연어처리_기말프로젝트/\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 3\u001b[0;31m \u001b[0;32mwith\u001b[0m \u001b[0mopen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m+\u001b[0m\u001b[0;34m'korean_wiki_preprocessed.pickle'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'wb'\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mfw\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      4\u001b[0m     \u001b[0mpickle\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdump\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0msentences4\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfw\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mFileNotFoundError\u001b[0m: [Errno 2] No such file or directory: 'drive/MyDrive/자연어처리_기말프로젝트/korean_wiki_preprocessed.pickle'"]}],"source":["path = \"https://drive.google.com/drive/folders/1WZs1R_DYdCaWE2LFtBQ7nFyA-YwcxnDn?usp=sharing/\"\n","path = \"drive/MyDrive/자연어처리_기말프로젝트/\"\n","with open(path+'korean_wiki_preprocessed.pickle', 'wb') as fw:\n","    pickle.dump(sentences4, fw)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0vyhDNfob6we"},"outputs":[],"source":["with open('korean_wiki_preprocessed.pickle', 'rb') as fw:\n","    corpus = pickle.load(fw)\n","corpus"]},{"cell_type":"markdown","source":["드라이브에 직접 저장 실패...왠지 모르겠다.  \n","일단 로컬로는 저장했음. 깃허브에 올린 다음 깃허브에서 다운받을 수 있게 해두겠음"],"metadata":{"id":"JXuejzOp9we8"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"3oxrxP3ghOyg","colab":{"base_uri":"https://localhost:8080/","height":17},"executionInfo":{"status":"ok","timestamp":1652722808865,"user_tz":-540,"elapsed":1696,"user":{"displayName":"이성주","userId":"00188276470697632312"}},"outputId":"204f0d4a-94ad-47f7-e855-d2075b5b83dc"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["\n","    async function download(id, filename, size) {\n","      if (!google.colab.kernel.accessAllowed) {\n","        return;\n","      }\n","      const div = document.createElement('div');\n","      const label = document.createElement('label');\n","      label.textContent = `Downloading \"${filename}\": `;\n","      div.appendChild(label);\n","      const progress = document.createElement('progress');\n","      progress.max = size;\n","      div.appendChild(progress);\n","      document.body.appendChild(div);\n","\n","      const buffers = [];\n","      let downloaded = 0;\n","\n","      const channel = await google.colab.kernel.comms.open(id);\n","      // Send a message to notify the kernel that we're ready.\n","      channel.send({})\n","\n","      for await (const message of channel.messages) {\n","        // Send a message to notify the kernel that we're ready.\n","        channel.send({})\n","        if (message.buffers) {\n","          for (const buffer of message.buffers) {\n","            buffers.push(buffer);\n","            downloaded += buffer.byteLength;\n","            progress.value = downloaded;\n","          }\n","        }\n","      }\n","      const blob = new Blob(buffers, {type: 'application/binary'});\n","      const a = document.createElement('a');\n","      a.href = window.URL.createObjectURL(blob);\n","      a.download = filename;\n","      div.appendChild(a);\n","      a.click();\n","      div.remove();\n","    }\n","  "]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Javascript object>"],"application/javascript":["download(\"download_c84cc52d-371d-4d9c-a3f1-f6996405d27a\", \"preprocessed.csv\", 28368407)"]},"metadata":{}}],"source":["from google.colab import files\n","sentences3.to_csv('preprocessed.csv')\n","files.download('preprocessed.csv')"]}],"metadata":{"colab":{"collapsed_sections":[],"name":"1_GLoVe_KOREAN_preprocessing","provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}